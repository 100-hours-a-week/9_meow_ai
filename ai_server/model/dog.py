
import re

def dog_converter(text):
    """í…ìŠ¤íŠ¸ë¥¼ ë©ì²´ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜"""
    if not text or not isinstance(text, str):
        return text
    
    result = text
       
    # ì˜ì–´ ë¬¸ì¥ ì²´í¬ (ì•ŒíŒŒë²³, ê³µë°±, ìˆ«ì, ê¸°ë³¸ ë¬¸ì¥ë¶€í˜¸ë§Œ í¬í•¨)
    if re.match(r'^[a-zA-Z\s\d.,!?;:\'"-]+$', result.strip()):
        # ë¬¸ì¥ ëì— ë¬¸ì¥ë¶€í˜¸ê°€ ìˆëŠ” ê²½ìš° ì•ì— meow ì¶”ê°€
        if re.search(r'[.!?]$', result.strip()):
            result = re.sub(r'([.!?])$', r' meow\1', result.strip())
        else:
            # ë¬¸ì¥ë¶€í˜¸ê°€ ì—†ëŠ” ê²½ìš° ê·¸ëƒ¥ meow ì¶”ê°€
            result = result.strip() + ' meow'
        return result
    # 0. ì‘ì€ë”°ì˜´í‘œ ì•ˆì˜ ë‚´ìš© ë³´í˜¸
    quoted_parts = {}
    quote_pattern = r"'([^']*?)'"
    
    def replace_quoted(match):
        placeholder = f"TEMP_QUOTE_{len(quoted_parts)}"
        quoted_parts[placeholder] = match.group(0)
        return placeholder
    
    result = re.sub(quote_pattern, replace_quoted, result)
    
    # 1. "ì•„ì•„" ë³´í˜¸ (ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸, ì˜ì„±ì–´)
    result = re.sub(r'ì•„ì•„', 'TEMP_AA', result)
    
    # 2. "ì•ˆë…•" â†’ "ë©í•˜" ë³€í™˜
    result = re.sub(r'ì•ˆë…•(?![í•˜íˆ])', 'ë©í•˜', result)
    
    # 3. "í•˜ì´" â†’ "ë©í•˜" ë³€í™˜ (ìƒˆë¡œ ì¶”ê°€)
    result = re.sub(r'í•˜ì´', 'ë©í•˜', result)

    result = re.sub(r'(ê°•ì•„ì§€|ê°œ)', 'ê°•ì•„ì§€ğŸ¶', result) 
    result = re.sub(r'(ë©ë©ì´|ë©ë­‰ì´|ë©ì´)', r'\1ğŸ¶', result)  # "ë©ë©ì´" â†’ "ë©ë©ì´ğŸ•"

    result = re.sub(r'(ë¯¸ì•¼ì˜¹ì¦ˆ|ë¯¸ì•¼ì˜¹)', r'âœ¨\1âœ¨', result)
    result = re.sub('í•´ë³´', 'í•´ë³´(ë°”ë³´)ğŸˆ', result)
    result = re.sub('ì†Œí”¼', 'ì†Œí”¼ğŸ€', result)
    result = re.sub(r'(í•´ë‚˜|í˜œë‚˜|í—¤ë‚˜|ë‹¤í˜œì‹ |ê³¤ë‡½\.|ê³¤ë‡½)',r'\1ğŸ¦–', result)

    # 4. ìƒˆë¡œìš´ ë³€í™˜ ê·œì¹™ë“¤ ì¶”ê°€
    # '-ë‚˜ìš”' â†’ 'ë©' ë³€í™˜
    result = re.sub(r'([ê°€-í£]+)ë‚˜ìš”(?=[!?\s.,]|$)', r'\1ë‚˜ë©', result)
    
    # '-ê°€ìš”' â†’ 'ê°€ì™ˆ' ë³€í™˜  
    result = re.sub(r'([ê°€-í£]+)ê°€ìš”(?=[!?\s.,]|$)', r'\1ê°€ì™ˆ', result)
    
    result = re.sub(r'ìš”\b', 'ì™ˆ', result)
    # 'í—' â†’ 'ì™ˆ' ë³€í™˜
    result = re.sub(r'(?<![ê°€-í£])í—(?![ê°€-í£])', 'ì™ˆ', result)
    
    # 'í•˜,' ë˜ëŠ” 'í•˜.' â†’ 'ë¼ì‰,' ë˜ëŠ” 'ë¼ì‰.' ë³€í™˜ (ì‰¼í‘œ/ë§ˆì¹¨í‘œê°€ ë¶™ì€ ê²½ìš°ë§Œ)
    result = re.sub(r'(?<![ê°€-í£])í•˜([,.])', r'ë¼ì‰\1', result)
    
    # '-ëƒ' â†’ 'ëƒê°œ' ë³€í™˜ (ë¬¸ì¥ ëì—ì„œ)
    result = re.sub(r'([ê°€-í£]+)ëƒ(?=[!?\s.,]|$)', r'\1ëƒê°œ', result)
    
    # '-ì§€ì£ ' â†’ '-ì§€ëƒì™ˆ' ë³€í™˜
    result = re.sub(r'([ê°€-í£]+)ì§€ì£ (?=[!?\s.,]|$)', r'\1ì§€ëƒì™ˆ', result)
    
    # '-ìë‚˜' â†’ 'ìëƒì™ˆ' ë³€í™˜
    result = re.sub(r'([ê°€-í£]+)ìë‚˜(?=[!?\s.,]|$)', r'\1ìëƒì™ˆ', result)
    
    # '-ì„' â†’ '-ì´ë‹¤ê°œ' ë³€í™˜
    result = re.sub(r'([ê°€-í£]+)ì„(?=[!?\s.,]|$)', r'\1ì´ë‹¤ê°œ', result)
    
    # '-ì–ì•„' â†’ '-ì–ëƒì™ˆ' ë³€í™˜
    result = re.sub(r'([ê°€-í£]+)ì–ì•„(?=[!?\s.,~]|$)', r'\1ì–ëƒì™ˆ', result)
    
    # ê³¼ê±°í˜• ì–´ë¯¸ ë³€í™˜ë“¤
    # '-ê²ë‹ˆë‹¤' â†’ '-ê±°ë‹¤ê°œ' ë³€í™˜ (ê¸´ íŒ¨í„´ ë¨¼ì €)
    result = re.sub(r'([ê°€-í£]+)ê²ë‹ˆë‹¤(?=[!?\s.,]|$)', r'\1ê±°ë‹¤ê°œ', result)
    
    # '-ì•˜ë‹¤' â†’ '-ì•˜ë‹¤ë©' ë³€í™˜
    result = re.sub(r'([ê°€-í£]+)ì•˜ë‹¤(?=[!?\s.,]|$)', r'\1ì•˜ë‹¤ë©', result)
    
    # '-ì—ˆë‹¤' â†’ '-ì—ˆë‹¤ì™ˆ' ë³€í™˜
    result = re.sub(r'([ê°€-í£]+)ì—ˆë‹¤(?=[!?\s.,]|$)', r'\1ì—ˆë‹¤ì™ˆ', result)
    
    # '-êµ°' â†’ '-êµ¬ì™€ì•Œ' ë³€í™˜
    result = re.sub(r'([ê°€-í£]+)êµ°(?=[!?\s.,]|$)', r'\1êµ¬ì™€ì•Œ', result)
    
    # íŠ¹ë³„ í˜•ìš©ì‚¬ ë³€í™˜

    
    # 5. ëŒ€ë‹µ ë³€í™˜: "ì‘" â†’ "ì™ˆ", "ë„¤" â†’ "ì™ˆ", "ì˜ˆ" â†’ "ì™ˆ" (ì œí•œì )
    result = re.sub(r'^ì‘(?=[!?\s.,]|$)', 'ì™ˆ', result)
    result = re.sub(r'(\s)ì‘(?=[!?\s.,]|$)', r'\1ì™ˆ', result)
    # "ë„¤"ëŠ” ëª…í™•í•œ ëŒ€ë‹µì¼ ë•Œë§Œ ë³€í™˜ (ë¬¸ì¥ë¶€í˜¸ì™€ í•¨ê»˜)
    result = re.sub(r'^ë„¤([!?.,])', r'ì™ˆ\1', result)  # ì›ë³¸ ë¬¸ì¥ë¶€í˜¸ ìœ ì§€
    result = re.sub(r'^ë„¤(?=\s*$)', 'ì™ˆ', result)  # ë‹¨ë…ìœ¼ë¡œ ëë‚˜ëŠ” ê²½ìš°
    result = re.sub(r'(\s)ë„¤([!?.,])', r'\1ì™ˆ\2', result)  # ì›ë³¸ ë¬¸ì¥ë¶€í˜¸ ìœ ì§€
    result = re.sub(r'(\s)ë„¤(?=\s*$)', r'\1ì™ˆ', result)  # ì¤‘ê°„ì— ë‹¨ë…ìœ¼ë¡œ ëë‚˜ëŠ” ê²½ìš°
    # "ì˜ˆ"ëŠ” ëª…í™•í•œ ëŒ€ë‹µì¼ ë•Œë§Œ ë³€í™˜ (ë¬¸ì¥ë¶€í˜¸ì™€ í•¨ê»˜)
    result = re.sub(r'^ì˜ˆ([!?.,])', r'ì™ˆ\1', result)  # ì›ë³¸ ë¬¸ì¥ë¶€í˜¸ ìœ ì§€
    result = re.sub(r'^ì˜ˆ(?=\s*$)', 'ì™ˆ', result)  # ë‹¨ë…ìœ¼ë¡œ ëë‚˜ëŠ” ê²½ìš°
    result = re.sub(r'(\s)ì˜ˆ([!?.,])', r'\1ì™ˆ\2', result)  # ì›ë³¸ ë¬¸ì¥ë¶€í˜¸ ìœ ì§€
    result = re.sub(r'(\s)ì˜ˆ(?=\s*$)', r'\1ì™ˆ', result)  # ì¤‘ê°„ì— ë‹¨ë…ìœ¼ë¡œ ëë‚˜ëŠ” ê²½ìš°
    
    # 6. ê°íƒ„ì‚¬ ë³€í™˜: ë¬¸ì¥ ë§¨ ì•ì˜ ê°íƒ„ì‚¬ ë³€í™˜ (ë¬¸ì¥ ë ì²˜ë¦¬ ì „ì— ì‹¤í–‰)
    result = re.sub(r'^(ì™€|ì˜¤|ì•„)(?=\s|$|[.!?,:;])', 'ì™•ì™•', result)

    
    # 7. ê°íƒ„ì‚¬ ë³€í™˜ (ì•—, ì•™, ìœ¼ì•…, ì•„ì•…) - ìœ„ì¹˜ì— ê´€ê³„ì—†ì´ ëª¨ë‘ ë³€í™˜
    result = re.sub(r'(?<![ê°€-í£])ì•™(?![ê°€-í£])', 'ì»¹', result)  # ì•ë’¤ì— í•œê¸€ì´ ì—†ëŠ” ê²½ìš°
    result = re.sub(r'(?<![ê°€-í£])ì•—(?![ê°€-í£])', 'ì»¹', result)  # ì•ë’¤ì— í•œê¸€ì´ ì—†ëŠ” ê²½ìš°
    result = re.sub(r'(?<![ê°€-í£])ìœ¼ì•…(?![ê°€-í£])', 'ìœ¼ë¥´ë ', result)  # ì•ë’¤ì— í•œê¸€ì´ ì—†ëŠ” ê²½ìš°
    result = re.sub(r'(?<![ê°€-í£])ì•„ì•…(?![ê°€-í£])', 'ìœ¼ë¥´ë ', result)  # ì•ë’¤ì— í•œê¸€ì´ ì—†ëŠ” ê²½ìš°
    
    # 8. ììŒ ì¡°í•© ë³€í™˜ (ê¸´ íŒ¨í„´ë¶€í„° ë¨¼ì € ì²˜ë¦¬)
    result = re.sub(r'ã…ã…‡ã…Œ', 'ë©ì´íŒ…', result)  # ã…ã…‡ë³´ë‹¤ ë¨¼ì € ì²˜ë¦¬
    result = re.sub(r'ã…ã…‡', 'ë©í•˜', result)
    result = re.sub(r'ã…‡ã…', 'ì–´ë©', result)
    result = re.sub(r'ã…ã…‡', 'ëª¨ëƒë©', result)
    result = re.sub(r'ã„±ã…Š', 'ê´œì°®ì»¹', result)  # ã„±ã…Š â†’ ê´œì°®ì»¹
    # ã„±ã…‡ã…‡ë¥¼ ì„ì‹œë¡œ ë³´í˜¸
    result = re.sub(r'ã„±ã…‡ã…‡', 'TEMP_GYY', result)
    # ã…‡ã…‡ ë³€í™˜
    result = re.sub(r'ã…‡ã…‡', 'ì›…ì™ˆ', result)
    # ã„±ã…‡ã…‡ ë³µì›
    result = re.sub(r'TEMP_GYY', 'ã„±ã…‡ã…‡', result)
    
    result = re.sub(r'ã…‡ã„¸', 'ì–´ë—˜ì»¹', result)
    result = re.sub(r'(?<![ê°€-í£])ì•„í•˜(?![ê°€-í£])', 'ì•„í•˜ì»¹', result)  # ì•ë’¤ì— í•œê¸€ì´ ì—†ëŠ” ë…ë¦½ëœ "ì•„í•˜"ë§Œ
    
        # ìƒˆë¡œìš´ ììŒ/ëª¨ìŒ ë³€í™˜ ê·œì¹™ë“¤
    result = re.sub(r'ã…‹ã…‹+', r'\g<0>ë©í•˜í•˜', result)  # ã…‹ã…‹ â†’ ã…‹ã…‹ë©í•˜í•˜ (ë’¤ì— ì¶”ê°€)
    result = re.sub(r'ã…ã…+', r'\g<0>í—¤í—¤í—¥~', result)  # ã…ã… â†’ ã…ã…í—¤í—¤~
    result = re.sub(r'ã…œ+', 'ë¼ì‰..', result)  # ã…œ â†’ ë¼ì‰..

    # 9. íŠ¹ë³„ ë‹¨ì–´/ì–´ì ˆ ì²˜ë¦¬
    # "ê°œì›ƒ" â†’ "ëŒ•ì›ƒ" (ê°œì›ƒê²¨, ê°œì›ƒê¸°ë‹¤, ê°œì›ƒê¹€ ë“±)
    result = re.sub(r'ê°œì›ƒ', 'ëŒ•ì›ƒ', result)
    
    # ê³µë°± ë’¤ ê°•ì¡° í‘œí˜„: "ê°œì´ì˜", "ê°œê·€ì—½", "ê°œê·€ì—¬" â†’ "ëŒ•ì´ì˜", "ëŒ•ê·€ì—½", "ëŒ•ê·€ì—¬" (ê°•ì¡° ìš©ë²•ë§Œ)
    result = re.sub(r'(\s)ê°œ(ì´ì˜|ê·€ì—½|ê·€ì—¬)', r'\1ëŒ•\2', result)  # ê³µë°± ë’¤ì—ë§Œ
    
    # "ì¡´" ê°•ì¡° í‘œí˜„ ë³€í™˜ (ê³µë°± ë’¤ì—ë§Œ)
    result = re.sub(r'(\s)ì¡´(ì¼|ë§›|ë§›íƒ±|ì˜ˆ|ê·€|ì¢‹)', r'\1ëŒ•\2', result)  # ê³µë°± ë’¤ì—ë§Œ


    result = re.sub(r'ëƒì˜¹', 'ëƒì™ˆ', result)
    result = re.sub(r'ë‹¤ì˜¹', 'ë‹¤ê°œ', result)
    
    # ë’¤ì— í•œê¸€ì´ ì˜¤ì§€ ì•ŠëŠ” ê²½ìš°ì—ë§Œ ë© ë¶™ì´ê¸°
    result = re.sub(r'(ë§ì•„|ë§ˆì|ë§ˆì¢Œ|ë§ˆìŸˆ)(?![ê°€-í£])', r'\1ì»¹', result)
    
    result = re.sub(r'([ê°€-í£])ë‹¤\b', r'\1ë‹¤ê°œ', result)
    result = re.sub(r'([ê°€-í£])ëƒ\b', r'\1ëƒì™ˆ', result)

        # íŠ¹ì • ì´ë¦„ ë³€í™˜
    result = re.sub(r'(?<![ê°€-í£])ì¡°ì´(?![ê°€-í£])', 'ì¡°ì´ë©ì´', result)
    result = re.sub(r'(?<![ê°€-í£])ë‘ì‹ì´(?![ê°€-í£])', 'ë‘ì‹ëƒ¥ì´', result)
    result = re.sub(r'(?<![ê°€-í£])ì„ì ˆë¯¸(?![ê°€-í£])', 'ì„ì ˆë©ì´', result)
    result = re.sub(r'(?<![ê°€-í£])í…ì‹œ(?![ê°€-í£])', 'í…ì‹œë©ì´', result)

    # 10. ë¬¸ì¥ ëì— "ë©" ì¶”ê°€ (í•œêµ­ì–´ê°€ í¬í•¨ëœ ê²½ìš°ë§Œ)
    if re.search(r'[ê°€-í£]', result):
        # ë¬¸ì¥ ë ì²˜ë¦¬ - ë¬¸ì¥ë¶€í˜¸ë¡œ ëë‚˜ëŠ” ê²½ìš°
        result = re.sub(r'([ê°€-í£])(?<!ë©)(\s*[.!?~\\,;]+)', r'\1ë©\2', result)  # ë¬¸ì¥ë¶€í˜¸ë¡œ ë (ê³µë°± í¬í•¨)
        
        # ì´ëª¨í‹°ì½˜ìœ¼ë¡œ ëë‚˜ëŠ” ê²½ìš°
        result = re.sub(r'([ê°€-í£])(?<!ë©)(\s*\^\^\s*$)', r'\1ë©\2', result)  # ^^ ì´ëª¨í‹°ì½˜
        result = re.sub(r'([ê°€-í£])(?<!ë©)(\s*:\)\s*$)', r'\1ë©\2', result)  # :) ì´ëª¨í‹°ì½˜
        result = re.sub(r'([ê°€-í£])(?<!ë©)(\s*[\U0001F600-\U0001F64F\U0001F300-\U0001F5FF\U0001F680-\U0001F6FF\U0001F1E0-\U0001F1FF\u2600-\u26FF\u2700-\u27BF]+\s*$)', r'\1ë©\2', result)  # ìœ ë‹ˆì½”ë“œ ì´ëª¨í‹°ì½˜
        
        # ììŒ/ëª¨ìŒ(ã…‹ã…‹, ã…ã…, ã…‡ã…‹ ë“±) ì•ì˜ í•œê¸€ì— "ë©" ì¶”ê°€
        result = re.sub(r'([ê°€-í£])(?<!ë©)(\s*[ã„±-ã…ã…-ã…£ã…‹ã…ã…‡ã…‹]+)', r'\1ë©\2', result)  # ììŒ/ëª¨ìŒ ì•
        
        # ì¤„ë°”ê¿ˆ ì²˜ë¦¬
        result = re.sub(r'([ê°€-í£])(?<!ë©)(\s*\r?\n)', r'\1ë©\2', result)  # ì¤„ë°”ê¿ˆìœ¼ë¡œ ë
        
        # ë¬¸ì¥ë¶€í˜¸ ì—†ì´ ëë‚˜ëŠ” ê²½ìš°
        result = re.sub(r'([ê°€-í£])(?<!ë©)(\s*$)', r'\1ë©\2', result)  # ê·¸ëƒ¥ ëë‚˜ëŠ” ê²½ìš°
    
    # 11. ê°íƒ„ì‚¬ ë³€í™˜: "ì™€!" â†’ "ì™•ì™•!", "ì˜¤!" â†’ "ì™•ì™•!" (ë¬¸ì¥ ë ì²˜ë¦¬ í›„ì— ì‹¤í–‰)
    result = re.sub(r'^ì™€!', 'ì™•ì™•!', result)
    result = re.sub(r'(\s)ì™€!', r'\1ì™•ì™•!', result)
    result = re.sub(r'^ì˜¤!', 'ì™•ì™•!', result)
    result = re.sub(r'(\s)ì˜¤!', r'\1ì™•ì™•!', result)
        #ë¯¸ì•¼ì˜¹ ì´ìŠ¤í„°ì—ê·¸
    



    # 12. ë¶ˆí•„ìš”í•œ "ë©" ì œê±° (íŠ¹ë³„ ë³€í™˜ í›„ ë¶™ì€ ë© ì •ë¦¬)
    # ë‹¨ì¼ íŒ¨í„´ ë’¤ì˜ ë© ì œê±°
    result = re.sub(r'(ì†Œí”¼|í•´ë³´(ë°”ë³´)|ê³¤ë‡½|ë©í•˜í•˜|ì»¹|ë¯¸ìŠ¤ì½”ë¦¬ëƒ¥|#ë¯¸ìŠ¤ì½”ë¦¬ëƒ¥|ì™ˆì™ˆ|ì™ˆ|ì™•ì™•|ì–´ë—˜ì»¹|ëƒí•˜|ì–´ë©|ëª¨ëƒë©|ê´œì°®ì»¹|ë©ì´íŒ…|ë…œ|ì™•ì™•|ëŒ•ì¼|ëŒ•ë§›|ëŒ•ë§›íƒ±|ëŒ•ì˜ˆ|ëŒ•ê·€|ëŒ•ì¢‹|ì™€ì•Œ|ê°œ|ë¼ì‰|ë¯¸ì•¼ì˜¹|ë¯¸ì•¼ì˜¹ì¦ˆ)ë©', r'\1', result)
    
    # ì—°ì† íŒ¨í„´ì˜ ë§ˆì§€ë§‰ì—ë§Œ ë© ë‚¨ê¸°ê¸° (ì˜ˆ: ë©í•˜ë©í•˜ë© â†’ ë©í•˜ë©í•˜)
    result = re.sub(r'(ë©í•˜)+ë©(?![ë©í•˜])', lambda m: m.group(0)[:-1], result)  # ë©í•˜ ì—°ì† í›„ ë§ˆì§€ë§‰ ë©ë§Œ ì œê±°
    result = re.sub(r'(ì›…ì™ˆ)+ë©(?![ì›…ì™ˆ])', lambda m: m.group(0)[:-1], result)  # ì›…ë© ì—°ì†ë„ ê°™ì€ ë°©ì‹
    
    # 13. "ì•„ì•„" ë³µì›
    result = re.sub(r'TEMP_AA', 'ì•„ì•„', result)
    
    # 14. ì‘ì€ë”°ì˜´í‘œ ë‚´ìš© ë³µì› (ë§¨ ë§ˆì§€ë§‰ì—)
    for placeholder, original in quoted_parts.items():
        result = result.replace(placeholder, original)
    
    return result