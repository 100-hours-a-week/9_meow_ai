import re

def monkey_converter(text):
    """í…ìŠ¤íŠ¸ë¥¼ ëª½í‚¤ì²´ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜"""

    if not text or not isinstance(text, str):
        return text
    
    result = text
   
    # ì˜ì–´ ë¬¸ì¥ ì²´í¬ (ì•ŒíŒŒë²³, ê³µë°±, ìˆ«ì, ê¸°ë³¸ ë¬¸ì¥ë¶€í˜¸ë§Œ í¬í•¨)
    if re.match(r'^[a-zA-Z\s\d.,!?;:\'"-]+$', result.strip()):
        # ë¬¸ì¥ ëì— ë¬¸ì¥ë¶€í˜¸ê°€ ìˆëŠ” ê²½ìš° ì•ì— meow ì¶”ê°€
        if re.search(r'[.!?]$', result.strip()):
            result = re.sub(r'([.!?])$', r' meow\1', result.strip())
        else:
            # ë¬¸ì¥ë¶€í˜¸ê°€ ì—†ëŠ” ê²½ìš° ê·¸ëƒ¥ meow ì¶”ê°€
            result = result.strip() + ' meow'
        return result

    # 0. ì‘ì€ë”°ì˜´í‘œ ì•ˆì˜ ë‚´ìš© ë³´í˜¸
    quoted_parts = {}
    quote_pattern = r"'([^']*?)'"
    
    def replace_quoted(match):
        placeholder = f"TEMP_QUOTE_{len(quoted_parts)}"
        quoted_parts[placeholder] = match.group(0)
        return placeholder
    
    result = re.sub(quote_pattern, replace_quoted, result)
    
    # 1. "ì•„ì•„" ë³´í˜¸ (ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸, ì˜ì„±ì–´)
    result = re.sub(r'ì•„ì•„', 'TEMP_AA', result)
    
    # 2. "ì•ˆë…•" â†’ "ëª½í•˜" ë³€í™˜
    result = re.sub(r'ì•ˆë…•\b', 'ëª½í•˜', result)
    # 3. "í•˜ì´" â†’ "ëª½í•˜" ë³€í™˜ (ìƒˆë¡œ ì¶”ê°€)
    result = re.sub(r'í•˜ì´', 'ëª½í•˜', result)
    result = re.sub(r'ë°”ì´', 'ëª½ë°”', result)
    result = re.sub(r'ë¹ ì´', 'ëª½ë¹ ', result)

    result = re.sub(r'ì‚¬ëŒë“¤', 'ìˆ­ì´ë“¤', result)
    
    result = re.sub(r'ì‚¬ëŒì´', 'ìˆ­ì´ê°€', result)  # "ì‚¬ëŒ" â†’ "ìˆ­ì´"
    result = re.sub(r'ì‚¬ëŒì„', 'ìˆ­ì´ë¥¼', result)  # "ì‚¬ëŒì„" â†’ "ìˆ­ì´ë¥¼"
    result = re.sub(r'ì‚¬ëŒì´ì•¼', 'ìˆ­ì´ì–Œ', result)  # "ì‚¬ëŒì´ì•¼" â†’ "ìˆ­ì´ì•¼"
    result = re.sub(r'ë‚˜ëŠ”\s*(\S+?)ì•¼', 'ë‚˜ëŠ” ìˆ­ì´ì•¼', result)  # "ë‚˜ëŠ” [í•œê¸€]ì•¼" â†’ "ë‚˜ëŠ” ìˆ­ì´ì•¼"
    result = re.sub(r'ì›ìˆ­ì´', r'ìˆ­ì´ğŸµ', result)  # "ìˆ­ì´" â†’ "ìˆ­ì´ğŸµ"

     # ììŒ ì¡°í•© ë³€í™˜ (ê¸´ íŒ¨í„´ë¶€í„° ë¨¼ì € ì²˜ë¦¬)
    result = re.sub(r'(ã…ã…‡ã…Œ|í™”ì´íŒ…|íŒŒì´íŒ…)', 'ëª½ì´íŒ…', result)  # ã…ã…‡ë³´ë‹¤ ë¨¼ì € ì²˜ë¦¬
    result = re.sub(r'ã…ã…‡', 'ëª½í•˜', result)
    result = re.sub(r'ã…‡ã…', 'ì–´ë¨¸ëª½', result)
    result = re.sub(r'ã…ã…‡', 'ëª¨ëƒëª½', result)
    result = re.sub(r'ã„±ã…Š', 'ê´œì°®ëª½', result)

    # ã„±ã…‡ã…‡ ê·€ì—½ë¼
    result = re.sub(r'ã„±ã…‡ã…‡', 'ê·€ì—½ë¼', result)
    # ã…‡ã…‡ ë³€í™˜
    result = re.sub(r'ã…‡ã…‡', 'ì›…ë¼ë¼', result)

    result = re.sub(r'^(ì™€|ì˜¤|ì•„)(?=\s|$|[.!?,:;])', 'ìš°!ì•„!ì•„!', result)

    # 9. íŠ¹ë³„ ë‹¨ì–´/ì–´ì ˆ ì²˜ë¦¬
    # "ê°œì›ƒ" â†’ "ëª½ì›ƒ" (ê°œì›ƒê²¨, ê°œì›ƒê¸°ë‹¤, ê°œì›ƒê¹€ ë“±)
    result = re.sub(r'ê°œì›ƒê¸°', 'ëª½ìš°ë¼', result)
    result = re.sub(r'ê°œì›ƒ', 'ëª½ì›ƒ', result)

    # ê³µë°± ë’¤ ê°•ì¡° í‘œí˜„: "ê°œì´ì˜", "ê°œê·€ì—½", "ê°œê·€ì—¬" â†’ "ëª½ì´ì˜", "ëª½ê·€ì—½", "ëª½ê·€ì—¬" (ê°•ì¡° ìš©ë²•ë§Œ)
    result = re.sub(r'(\s)ê°œ(ì´ì˜|ê·€ì—½|ê·€ì—¬)', r'\1ëª½\2', result)  # ê³µë°± ë’¤ì—ë§Œ
    
    # "ì¡´" ê°•ì¡° í‘œí˜„ ë³€í™˜ (ê³µë°± ë’¤ì—ë§Œ)
    result = re.sub(r'(\s)ì¡´(ì¼|ë§›|ë§›íƒ±|ì˜ˆ|ê·€|ì¢‹)', r'\1ëª½\2', result)  # ê³µë°± ë’¤ì—ë§Œ 
    
    # ë’¤ì— í•œê¸€ì´ ì˜¤ì§€ ì•ŠëŠ” ê²½ìš°ì—ë§Œ ë¼ë¼ ë¶™ì´ê¸°
    result = re.sub(r'(ë§ì•„|ë§ˆì|ë§ˆì¢Œ|ë§ˆìŸˆ)(?![ê°€-í£])', r'\1ë¼ë¼', result)
    
    result = re.sub(r'([ê°€-í£])ë‹¤\b', r'\1ë‹¤ë¼ë¼', result)
    result = re.sub(r'([ê°€-í£])ëƒ\b', r'\1ëƒë¼ë¼', result)


    result = re.sub(r'ëƒ(ë©|ê°œ|ì˜¹|ì™ˆ)', 'ëƒë¼ë¼', result)
    result = re.sub(r'ë‹¤(ì˜¹|ë©|ê°œ|ì™ˆ)', 'ë‹¤ë¼ë¼', result)
    result = re.sub(r'ë‹¤\b', 'ë‹¤ë¼ë¼', result)
    result = re.sub(r'ìš”\b', 'ìš”ë¼ë¼', result)
    result = re.sub(r'ë©/b', 'ë¼ë¼', result)
    result = re.sub(r'êµ°/b', 'êµ°ë¼ë¼', result)
    
    # ë¯¸ì•¼ì˜¹ ì´ìŠ¤í„°ì—ê·¸  
    result = re.sub(r'ë¯¸ì•¼ì˜¹ì¦ˆ', 'âœ¨ë¯¸ì•¼ì˜¹ì¦ˆâœ¨', result)
    result = re.sub(r'ë¯¸ì•¼ì˜¹', 'âœ¨ë¯¸ì•¼ì˜¹âœ¨', result)
    result = re.sub('í•´ë³´', 'í•´ë³´(ë°”ë³´)ğŸˆ', result)
    result = re.sub('ì†Œí”¼', 'ì†Œí”¼ğŸ€', result)


    # 5. ëŒ€ë‹µ ë³€í™˜: "ì‘" â†’ "ë­‰", "ë„¤" â†’ "ë­‰", "ì˜ˆ" â†’ "ëª¡" (ì œí•œì )
    result = re.sub(r'^ì‘(?=[!?\s.,]|$)', 'ë­‰', result)
    result = re.sub(r'(\s)ì‘(?=[!?\s.,]|$)', r'\1ë­‰', result)
    # "ë„¤"ëŠ” ëª…í™•í•œ ëŒ€ë‹µì¼ ë•Œë§Œ ë³€í™˜ (ë¬¸ì¥ë¶€í˜¸ì™€ í•¨ê»˜)
    result = re.sub(r'^ë„¤([!?.,])', r'ë­‰\1', result)  # ì›ë³¸ ë¬¸ì¥ë¶€í˜¸ ìœ ì§€
    result = re.sub(r'^ë„¤(?=\s*$)', 'ë­‰', result)  # ë‹¨ë…ìœ¼ë¡œ ëë‚˜ëŠ” ê²½ìš°
    result = re.sub(r'(\s)ë„¤([!?.,])', r'\1ë­‰\2', result)  # ì›ë³¸ ë¬¸ì¥ë¶€í˜¸ ìœ ì§€
    result = re.sub(r'(\s)ë„¤(?=\s*$)', r'\1ë­‰', result)  # ì¤‘ê°„ì— ë‹¨ë…ìœ¼ë¡œ ëë‚˜ëŠ” ê²½ìš°
    # "ì˜ˆ"ëŠ” ëª…í™•í•œ ëŒ€ë‹µì¼ ë•Œë§Œ ë³€í™˜ (ë¬¸ì¥ë¶€í˜¸ì™€ í•¨ê»˜)
    result = re.sub(r'^ì˜ˆ([!?.,])', r'ëª¡\1', result)  # ì›ë³¸ ë¬¸ì¥ë¶€í˜¸ ìœ ì§€
    result = re.sub(r'^ì˜ˆ(?=\s*$)', 'ëª¡', result)  # ë‹¨ë…ìœ¼ë¡œ ëë‚˜ëŠ” ê²½ìš°
    result = re.sub(r'(\s)ì˜ˆ([!?.,])', r'\1ëª¡\2', result)  # ì›ë³¸ ë¬¸ì¥ë¶€í˜¸ ìœ ì§€
    result = re.sub(r'(\s)ì˜ˆ(?=\s*$)', r'\1ëª¡', result)  # ì¤‘ê°„ì— ë‹¨ë…ìœ¼ë¡œ ëë‚˜ëŠ” ê²½ìš°
    
    # 10. ë¬¸ì¥ ëì— "ëª½" ì¶”ê°€ (í•œêµ­ì–´ê°€ í¬í•¨ëœ ê²½ìš°ë§Œ)
    if re.search(r'[ê°€-í£]', result):
        # ë¬¸ì¥ ë ì²˜ë¦¬ - ë¬¸ì¥ë¶€í˜¸ë¡œ ëë‚˜ëŠ” ê²½ìš°
        result = re.sub(r'([ê°€-í£])(?<!ëª½)(\s*[.!?~\\;]+)(?![ê°€-í£])', r'\1ëª½\2', result)

        
        # ì´ëª¨í‹°ì½˜ìœ¼ë¡œ ëë‚˜ëŠ” ê²½ìš°
        result = re.sub(r'([ê°€-í£])(?<!ëª½)(\s*\^\^\s*$)', r'\1ëª½\2', result)  # ^^ ì´ëª¨í‹°ì½˜
        result = re.sub(r'([ê°€-í£])(?<!ëª½)(\s*:\)\s*$)', r'\1ëª½\2', result)  # :) ì´ëª¨í‹°ì½˜
        result = re.sub(r'([ê°€-í£])(?<!ëª½)(\s*[\U0001F600-\U0001F64F\U0001F300-\U0001F5FF\U0001F680-\U0001F6FF\U0001F1E0-\U0001F1FF\u2600-\u26FF\u2700-\u27BF]+\s*$)', r'\1ëª½\2', result)  # ìœ ë‹ˆì½”ë“œ ì´ëª¨í‹°ì½˜
        
        # ììŒ/ëª¨ìŒ(ã…‹ã…‹, ã…ã…, ã…‡ã…‹ ë“±) ì•ì˜ í•œê¸€ì— "ëª½" ì¶”ê°€
        result = re.sub(r'([ê°€-í£])(?<!ëª½)(\s*[ã„±-ã…ã…-ã…£ã…‹ã…ã…‡ã…‹]+)', r'\1ëª½\2', result)  # ììŒ/ëª¨ìŒ ì•
        
        # ì¤„ë°”ê¿ˆ ì²˜ë¦¬
        result = re.sub(r'([ê°€-í£])(?<!ëª½)(\s*\r?\n)', r'\1ëª½\2', result)  # ì¤„ë°”ê¿ˆìœ¼ë¡œ ë
        
        # ë¬¸ì¥ë¶€í˜¸ ì—†ì´ ëë‚˜ëŠ” ê²½ìš°
        result = re.sub(r'([ê°€-í£])(?<!ëª½)(\s*$)', r'\1ëª½\2', result)  # ê·¸ëƒ¥ ëë‚˜ëŠ” ê²½ìš°
    

    # 12. ë¶ˆí•„ìš”í•œ "ëª½" ì œê±° (íŠ¹ë³„ ë³€í™˜ í›„ ë¶™ì€ ëª½ ì •ë¦¬)
    # ë‹¨ì¼ íŒ¨í„´ ë’¤ì˜ ëª½ ì œê±°
    result = re.sub(r'(ë¼|ë­‰|ëª¡|ëª½|ëª½ì´íŒ…|ëª½í•˜|ëª½ë°”|ëª½ë¹ |ëª½ì¼|ëª½ë§›|ëª½ë§›íƒ±|ëª½ì˜ˆ|ëª½ê·€|ëª½ì¢‹|ìš°!ì•„!ì•„|ë¯¸ì•¼ì˜¹ì¦ˆ|ë¯¸ì•¼ì˜¹)ëª½', r'\1', result)
    
    # ã…‹ ê°œìˆ˜ë³„ ë³€í™˜ (ê¸´ íŒ¨í„´ë¶€í„° ë¨¼ì € ì²˜ë¦¬)
    result = re.sub(r'ã…‹{26,}', 'ã„²ã„²ã„²í¬í‚„í‚„ã„²ã„²í‚¤ë¼ë¼ìš°ë¼í‚¼ã„²ìº­ìº­ìš°ì»„ã„²ã„²ã„²ã„²ã„²ã„²ã„²ã„²ìº¬', result)
    result = re.sub(r'ã…‹{15,25}', 'ìš°í‚¤í‚¼ã„²ã„²ã„²ã„²ã„²ã…Œìš°ë¼ìš°ë‚”ã„²ã„²ã„²ã„²', result)
    result = re.sub(r'ã…‹{8,14}', 'ìš°ë¼ìš°ë‚”ã„²ã„²ã„²ã„²ã„²', result)
    result = re.sub(r'ã…‹{4,7}', 'ìš°í‚¤í‚¼ã„²ã„²ã„²', result)
    result = re.sub(r'ã…‹{3}', 'ìš°í‚¤í‚¼ã„²', result)
    result = re.sub(r'ã…‹{2}', 'ìš°í‚¤í‚¤', result)
    result = re.sub(r'ã…‹{1}', 'ìš°ë‚”', result)

    
    result = re.sub(r'TEMP_AA', 'ì•„ì•„', result)
    # 13. ì‘ì€ë”°ì˜´í‘œ ì•ˆì˜ ë‚´ìš© ë³µì›
    for placeholder, original in quoted_parts.items():
        result = result.replace(placeholder, original)


    return result